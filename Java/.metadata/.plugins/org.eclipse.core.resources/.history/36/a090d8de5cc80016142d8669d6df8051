package pers.fhr.exceldemo.util;

import java.io.FileInputStream;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;

import jxl.Cell;
import jxl.Sheet;
import jxl.Workbook;
/**
 * Excel帮助类
 * @author fhr
 *
 */
public class ExcelUtil {
  /**
   * 以二维数组形式获取Excel所有值
   * @param fileName
   * @return
   */
  public static List<String[][]> readExcel(String fileName){
	  List<String[][]> bookValues=new ArrayList<>();
	  Workbook readWb=null;
		try{
			InputStream inputStream=new FileInputStream(fileName);
			readWb=Workbook.getWorkbook(inputStream);
			 Sheet [] sheets=readWb.getSheets();
			for(Sheet readsheet : sheets){
				int columns=readsheet.getColumns();
				int rows=readsheet.getRows();
				String [][]sheetValue=new String[rows][columns];
				for(int i=0;i<rows;i++){
					for(int j=0;j<columns;j++){
						Cell cell=readsheet.getCell(j, i);
						sheetValue[i][j]=cell.getContents();
					}
				}
				bookValues.add(sheetValue);
			}
		}catch(Exception e){
			System.out.print( e.getMessage());
		}
		return bookValues;
  }
  public static String[][] readExcel(String fileName,String sheetName){
	  Workbook readWb=null;
		try{
			InputStream inputStream=new FileInputStream(fileName);
			readWb=Workbook.getWorkbook(inputStream);
			 Sheet sheet=readWb.getSheet(sheetName);
				int columns=sheet.getColumns();
				int rows=sheet.getRows();
				String [][]sheetValue=new String[rows][columns];
				for(int i=0;i<rows;i++){
					for(int j=0;j<columns;j++){
						Cell cell=sheet.getCell(j, i);
						sheetValue[i][j]=cell.getContents();
					}
				
				
			}
		}catch(Exception e){
			System.out.print( e.getMessage());
		}
		return bookValues;
  }
}
